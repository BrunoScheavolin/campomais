<div class="container">
  <div class="mb-4 p-4">
    <%= form_with url: admin_finances_path, method: :get, local: true do %>
      <div class="row gx-3 gy-3">
        <div class="col-6">
          <label class="form-label text-white" for="property_id">Propriedade</label>
          <%= select_tag :property_id,
                         options_from_collection_for_select(@properties, :id, :name, params[:property_id]),
                         include_blank: "Todas",
                         class: "form-select custom-select-style",
                         id: "property_id",
                         onchange: "this.form.submit()" %>
        </div>

        <div class="col-6">
          <label class="form-label text-white" for="animal_production_id">Produção</label>
          <%= select_tag :animal_production_id,
                         options_from_collection_for_select(@animal_productions, :id, :name, params[:animal_production_id]),
                         include_blank: "Todas",
                         class: "form-select custom-select-style",
                         id: "animal_production_id",
                         onchange: "this.form.submit()" %>
        </div>

        <div class="col-6">
          <label class="form-label text-white" for="transaction_type">Tipo</label>
          <%= select_tag :transaction_type,
                         options_for_select([["Todas", ""], ["Receitas", "revenues"], ["Despesas", "expenses"]], params[:transaction_type]),
                         class: "form-select custom-select-style",
                         id: "transaction_type",
                         onchange: "this.form.submit()" %>
        </div>

        <div class="col-6">
          <label class="form-label text-white" for="start_date">A partir de</label>
          <%= date_field_tag :start_date,
                             params[:start_date],
                             class: "form-control custom-select-style",
                             id: "start_date",
                             onchange: "this.form.submit()" %>
        </div>
      </div>

  <% end %>
  </div>

  <div class="mb-5 bg-white rounded-5 shadow-sm p-4">
    <% @transactions.each do |t| %>
      <% record = t["record"] %>
      <% is_revenue = t["type"] == "Receita" %>
      <div class="d-flex align-items-center justify-content-between mb-3">
        <div class="d-flex align-items-center">
          <div class="<%= is_revenue ? 'bg-success' : 'bg-danger' %> text-white rounded-circle d-flex justify-content-center align-items-center me-3" style="width: 45px; height: 45px;">
            <i class="bi <%= is_revenue ? 'bi-cash-stack' : 'bi-cart-dash' %> fs-5"></i>
          </div>
          <div>
            <div><strong><%= record.description %></strong></div>
            <small class="text-muted"><%= record.created_at.strftime("%H:%M – %d %B") %></small>
          </div>
        </div>
        <div class="text-end">
          <small><%= record.animal_production&.property&.name || "Sem propriedade" %></small>
          <div class="<%= is_revenue ? 'text-success' : 'text-danger' %> fw-bold">
            <%= is_revenue ? "R$" : "-R$" %> <%= number_to_currency(record.value, unit: "", separator: ",", delimiter: ".") %>
          </div>
        </div>
      </div>
    <% end %>
  </div>

</div>
